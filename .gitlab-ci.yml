image: node:14.18

stages:
    - test
    - build

ESLinter:
    stage: test
    script:
        - npm i
        - node ./node_modules/eslint/bin/eslint.js src/
    cache:
        key: ${CI_COMMIT_BRANCH}
        paths:
            - node_modules

Build Nitro:
    stage: build
    script:
        - cp src/.env.example src/.env
        - cp src/renderer-config.json.example src/renderer-config.json
        - cp src/ui-config.json.example src/ui-config.json
        - npm i
        - npm run build-prod
    cache:
        key: ${CI_COMMIT_BRANCH}
        paths:
            - node_modules
    artifacts:
        expire_in: 2 weeks
        paths:
            - dist/*
